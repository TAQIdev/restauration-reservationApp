server.port=8080

spring.application.name=api-gateway
spring.config.import=optional:configserver:${CONFIG_SERVER_URL:http://localhost:8888}

spring.cloud.gateway.discovery.locator.enabled=false
spring.cloud.gateway.discovery.locator.lower-case-service-id=true

# ===========================
# Restaurant Service Route
# ===========================
spring.cloud.gateway.routes[0].id=restaurant-service
spring.cloud.gateway.routes[0].uri=lb://restaurant-service
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/restaurants/**
spring.cloud.gateway.routes[0].filters[0].name=CircuitBreaker
spring.cloud.gateway.routes[0].filters[0].args.name=restaurantServiceCircuitBreaker
spring.cloud.gateway.routes[0].filters[0].args.fallbackUri=forward:/fallback/restaurant

# ===========================
# Reservation Service Auth
# ===========================
spring.cloud.gateway.routes[1].id=reservation-service-auth
spring.cloud.gateway.routes[1].uri=lb://reservation-service
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/auth/**

# ===========================
# Reservation Service Reservations
# ===========================
spring.cloud.gateway.routes[2].id=reservation-service-reservations
spring.cloud.gateway.routes[2].uri=lb://reservation-service
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/reservations/**
spring.cloud.gateway.routes[2].filters[0].name=CircuitBreaker
spring.cloud.gateway.routes[2].filters[0].args.name=reservationServiceCircuitBreaker
spring.cloud.gateway.routes[2].filters[0].args.fallbackUri=forward:/fallback/reservation

# ===========================
# Search Service Route
# ===========================
# Client Web Service Route (Search Functionality)
spring.cloud.gateway.routes[3].id=client-web-search
spring.cloud.gateway.routes[3].uri=lb://client-web
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/search/**


# ===========================
# CORS Global
# ===========================
spring.cloud.gateway.globalcors.cors-configurations['[/**]'].allowed-origins=*
spring.cloud.gateway.globalcors.cors-configurations['[/**]'].allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.cloud.gateway.globalcors.cors-configurations['[/**]'].allowed-headers=*
spring.cloud.gateway.globalcors.cors-configurations['[/**]'].allow-credentials=true

# ===========================
# Eureka
# ===========================
eureka.client.service-url.defaultZone=${EUREKA_SERVER_URL:http://localhost:8761/eureka}
eureka.client.fetch-registry=true
eureka.client.register-with-eureka=true

# ===========================
# Actuator exposure
# ===========================
management.endpoints.web.exposure.include=health,info,gateway
